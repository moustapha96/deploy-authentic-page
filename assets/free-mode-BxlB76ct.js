import{bi as v,az as h}from"./index-KgXPvRKN.js";function z(g){let{swiper:e,extendParams:x,emit:c,once:S}=g;x({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function E(){if(e.params.cssMode)return;const s=e.getTranslate();e.setTranslate(s),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function b(){if(e.params.cssMode)return;const{touchEventsData:s,touches:m}=e;s.velocities.length===0&&s.velocities.push({position:m[e.isHorizontal()?"startX":"startY"],time:s.touchStartTime}),s.velocities.push({position:m[e.isHorizontal()?"currentX":"currentY"],time:v()})}function B(s){let{currentPos:m}=s;if(e.params.cssMode)return;const{params:i,wrapperEl:f,rtlTranslate:p,snapGrid:a,touchEventsData:r}=e,w=v()-r.touchStartTime;if(m<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(m>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(i.freeMode.momentum){if(r.velocities.length>1){const o=r.velocities.pop(),n=r.velocities.pop(),P=o.position-n.position,y=o.time-n.time;e.velocity=P/y,e.velocity/=2,Math.abs(e.velocity)<i.freeMode.minimumVelocity&&(e.velocity=0),(y>150||v()-o.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=i.freeMode.momentumVelocityRatio,r.velocities.length=0;let l=1e3*i.freeMode.momentumRatio;const D=e.velocity*l;let t=e.translate+D;p&&(t=-t);let M=!1,u;const d=Math.abs(e.velocity)*20*i.freeMode.momentumBounceRatio;let T;if(t<e.maxTranslate())i.freeMode.momentumBounce?(t+e.maxTranslate()<-d&&(t=e.maxTranslate()-d),u=e.maxTranslate(),M=!0,r.allowMomentumBounce=!0):t=e.maxTranslate(),i.loop&&i.centeredSlides&&(T=!0);else if(t>e.minTranslate())i.freeMode.momentumBounce?(t-e.minTranslate()>d&&(t=e.minTranslate()+d),u=e.minTranslate(),M=!0,r.allowMomentumBounce=!0):t=e.minTranslate(),i.loop&&i.centeredSlides&&(T=!0);else if(i.freeMode.sticky){let o;for(let n=0;n<a.length;n+=1)if(a[n]>-t){o=n;break}Math.abs(a[o]-t)<Math.abs(a[o-1]-t)||e.swipeDirection==="next"?t=a[o]:t=a[o-1],t=-t}if(T&&S("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(p?l=Math.abs((-t-e.translate)/e.velocity):l=Math.abs((t-e.translate)/e.velocity),i.freeMode.sticky){const o=Math.abs((p?-t:t)-e.translate),n=e.slidesSizesGrid[e.activeIndex];o<n?l=i.speed:o<2*n?l=i.speed*1.5:l=i.speed*2.5}}else if(i.freeMode.sticky){e.slideToClosest();return}i.freeMode.momentumBounce&&M?(e.updateProgress(u),e.setTransition(l),e.setTranslate(t),e.transitionStart(!0,e.swipeDirection),e.animating=!0,h(f,()=>{!e||e.destroyed||!r.allowMomentumBounce||(c("momentumBounce"),e.setTransition(i.speed),setTimeout(()=>{e.setTranslate(u),h(f,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(c("_freeModeNoMomentumRelease"),e.updateProgress(t),e.setTransition(l),e.setTranslate(t),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,h(f,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(t),e.updateActiveIndex(),e.updateSlidesClasses()}else if(i.freeMode.sticky){e.slideToClosest();return}else i.freeMode&&c("_freeModeNoMomentumRelease");(!i.freeMode.momentum||w>=i.longSwipesMs)&&(c("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:E,onTouchMove:b,onTouchEnd:B}})}export{z as f};
